<!DOCTYPE html>
<html lang="zh-TW" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YU.YOU.MAKEUP | 專屬韓系訂製妝容</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="YU.YOU.MAKEUP 提供專屬韓系光感底妝與造型服務，打造自然精緻氣色。立即線上預約！">
    <meta property="og:title" content="YU.YOU.MAKEUP | 韓系造型預約">
    <meta property="og:description" content="自然光感底妝與造型，將優雅化為日常氣場。">
    <!-- 這裡的 og:image 也可以換成您的 photo1.jpg，但為了分享時能顯示，通常建議用網址，或者上傳後 Netlify 會自動處理相對路徑 -->
    <meta property="og:image" content="images/photo1.jpg">
    <meta property="og:url" content="">
    <meta property="og:type" content="website">

    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 引入 Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- 引入 Google Fonts (Playfair Display) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">

    <!-- 自定義樣式 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        ivory: '#F5F1E6',
                        charcoal: '#4A4A4A',
                        'soft-pink': '#F2C8C0',
                        'grey-brown': '#D0B8A8',
                    },
                    fontFamily: { 
                        sans: ['Helvetica Neue', 'Arial', 'sans-serif'],
                        serif: ['"Playfair Display"', 'serif']
                    },
                    keyframes: { 
                        fadeInUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        spinSlow: { '0%': { transform: 'rotate(0deg)' }, '100%': { transform: 'rotate(360deg)' } }
                    },
                    animation: { 
                        'fade-in-up': 'fadeInUp 0.8s ease-out forwards',
                        'spin-slow': 'spinSlow 2s linear infinite'
                    },
                    scrollMargin: { '40': '160px' }
                }
            }
        }
    </script>

    <style>
        body { background-color: #F5F1E6; color: #4A4A4A; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        ::selection { background: #F2C8C0; color: #4A4A4A; }
        section, #time-slot-section, #booking-form { scroll-margin-top: 160px; }
        .custom-select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234A4A4A' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            background-size: 1.2em;
        }
        /* 作品集圖片遮罩效果 */
        .gallery-overlay {
            background: linear-gradient(to top, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0) 50%);
        }
    </style>
</head>
<body class="font-sans antialiased relative">

    <!-- Header -->
    <header id="hero-section" class="relative w-full min-h-[95vh] flex flex-col items-center justify-center overflow-hidden bg-ivory transition-all duration-500">
        <div class="absolute top-0 left-0 w-full h-full pointer-events-none select-none opacity-5 overflow-hidden flex flex-col justify-between py-10 z-0">
            <span class="text-[12vw] font-bold tracking-widest leading-none text-center text-charcoal/5">MAKEUP</span>
            <span class="text-[12vw] font-bold tracking-widest leading-none text-center text-charcoal/5">STYLING</span>
            <span class="text-[12vw] font-bold tracking-widest leading-none text-center text-charcoal/5">ARTIST</span>
        </div>
        <div class="relative z-10 text-center px-4 md:px-6 animate-fade-in-up flex flex-col items-center gap-6 md:gap-8">
            <div class="flex gap-4 md:gap-8 text-grey-brown text-xs md:text-sm tracking-[0.3em] font-light uppercase">
                <span>Natural</span><span>•</span><span>Glow</span><span>•</span><span>Elegance</span>
            </div>
            <h1 id="main-title" class="font-serif italic text-4xl sm:text-5xl md:text-7xl lg:text-8xl tracking-widest text-charcoal transition-all duration-500 break-words w-full max-w-4xl leading-tight">
                YU.YOU<br>MAKE UP
            </h1>
            <div class="space-y-4 max-w-lg mx-auto px-4">
                <p id="main-slogan" class="font-serif italic text-xl md:text-2xl text-charcoal/90 tracking-wider leading-relaxed transition-all duration-500">
                    We welcome your reservation
                </p>
            </div>
            <div class="w-16 h-[1px] bg-grey-brown my-4"></div>
            <button onclick="scrollToNextStep()" class="group mt-4 px-10 py-4 border border-charcoal text-charcoal hover:bg-charcoal hover:text-ivory transition-all duration-500 rounded-full tracking-widest text-sm uppercase">
                Reservation
            </button>
        </div>
    </header>

    <!-- Price Bar -->
    <div id="price-bar" class="fixed top-0 left-0 w-full bg-white/90 backdrop-blur-md shadow-sm z-50 transition-transform duration-300 border-b border-grey-brown/30 -translate-y-full">
        <div class="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center">
            <span class="text-sm font-light tracking-wider">目前選擇組合</span>
            <div class="flex items-center gap-4">
                <span class="text-lg font-normal">NT$ <span id="total-price-display">0</span></span>
                <button onclick="scrollToNextStep()" class="text-xs bg-charcoal text-white px-6 py-2.5 rounded-full hover:bg-black transition-colors shadow-lg font-medium tracking-wide">
                    下一步
                </button>
            </div>
        </div>
    </div>

    <main class="max-w-6xl mx-auto px-6 py-20 space-y-24 relative">

        <!-- ★★★ 精選作品集 (Style Gallery) ★★★ -->
        <!-- 已修改為本地圖片路徑 -->
        <section id="gallery-section">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-light tracking-widest mb-4">STYLE GALLERY</h2>
                <div class="w-12 h-[1px] bg-grey-brown mx-auto"></div>
                <p class="mt-4 text-charcoal/70 font-light text-sm">精選韓系妝容作品</p>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 h-96 md:h-80">
                
                <!-- 照片 1 -->
                <div class="relative group overflow-hidden rounded-xl cursor-pointer h-full">
                    <img src="images/photo1.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="作品 1" onerror="this.src='https://images.unsplash.com/photo-1512413914633-b5043f4041ea?q=80&w=800&auto=format&fit=crop'">
                    <div class="absolute inset-0 gallery-overlay opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end justify-center p-4">
                        <span class="text-white text-xs tracking-widest uppercase">Clean Beauty</span>
                    </div>
                </div>
                
                <!-- 照片 2 -->
                <div class="relative group overflow-hidden rounded-xl cursor-pointer h-full">
                    <img src="images/photo2.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="作品 2" onerror="this.src='https://images.unsplash.com/photo-1522337360788-8b13dee7a37e?q=80&w=800&auto=format&fit=crop'">
                    <div class="absolute inset-0 gallery-overlay opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end justify-center p-4">
                        <span class="text-white text-xs tracking-widest uppercase">K-Style Glow</span>
                    </div>
                </div>
                
                <!-- 照片 3 -->
                <div class="relative group overflow-hidden rounded-xl cursor-pointer h-full">
                    <img src="images/photo3.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="作品 3" onerror="this.src='https://images.unsplash.com/photo-1595959183082-7bce708474fd?q=80&w=800&auto=format&fit=crop'">
                    <div class="absolute inset-0 gallery-overlay opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end justify-center p-4">
                        <span class="text-white text-xs tracking-widest uppercase">Daily Chic</span>
                    </div>
                </div>
                
                <!-- 照片 4 -->
                <div class="relative group overflow-hidden rounded-xl cursor-pointer h-full">
                    <img src="images/photo4.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="作品 4" onerror="this.src='https://images.unsplash.com/photo-1500917293891-ef795e70e1f6?q=80&w=800&auto=format&fit=crop'">
                    <div class="absolute inset-0 gallery-overlay opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end justify-center p-4">
                        <span class="text-white text-xs tracking-widest uppercase">Elegant</span>
                    </div>
                </div>

            </div>
        </section>
        
        <!-- Admin Password Modal -->
        <div id="password-modal" class="hidden fixed inset-0 z-[70] bg-charcoal/50 flex items-center justify-center p-6 backdrop-blur-sm">
            <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-sm w-full text-center">
                <h3 class="text-xl font-bold mb-4 text-charcoal">管理員驗證</h3>
                <input type="password" id="admin-password-input" class="w-full bg-ivory border border-grey-brown/30 rounded-lg px-4 py-3 text-center tracking-widest mb-4 focus:ring-2 focus:ring-soft-pink outline-none" placeholder="輸入密碼">
                <div class="flex gap-3">
                    <button onclick="closePasswordModal()" class="flex-1 py-3 bg-gray-100 text-charcoal rounded-lg font-medium hover:bg-gray-200">取消</button>
                    <button onclick="verifyPassword()" class="flex-1 py-3 bg-charcoal text-white rounded-lg font-medium hover:bg-black">確認</button>
                </div>
            </div>
        </div>

        <!-- Info Modal -->
        <div id="info-modal" class="hidden fixed inset-0 z-[80] bg-charcoal/50 flex items-center justify-center p-6 backdrop-blur-sm transition-opacity duration-300">
            <div class="bg-white w-full max-w-2xl max-h-[80vh] rounded-2xl shadow-2xl flex flex-col overflow-hidden relative animate-fade-in-up">
                <div class="p-6 border-b border-grey-brown/20 flex justify-between items-center bg-ivory sticky top-0 z-10">
                    <h3 id="info-modal-title" class="text-xl font-bold text-charcoal tracking-wide">標題</h3>
                    <button onclick="closeInfoModal()" class="p-2 hover:bg-grey-brown/20 rounded-full transition-colors">
                        <i data-lucide="x" class="w-5 h-5 text-charcoal"></i>
                    </button>
                </div>
                <div id="info-modal-content" class="p-8 overflow-y-auto text-sm text-charcoal/80 leading-relaxed space-y-4"></div>
            </div>
        </div>

        <!-- Success View -->
        <div id="success-view" class="hidden fixed inset-0 z-[60] bg-ivory flex items-center justify-center p-6">
            <div class="bg-white p-8 md:p-12 rounded-3xl shadow-xl max-w-lg w-full text-center border border-soft-pink/30 animate-fade-in-up relative overflow-y-auto max-h-[90vh]">
                <div id="copy-toast" class="absolute top-4 left-1/2 -translate-x-1/2 bg-charcoal text-white text-xs py-2 px-4 rounded-full opacity-0 transition-opacity pointer-events-none z-50 shadow-lg whitespace-nowrap">
                    預約單已複製！前往 LINE...
                </div>
                <div class="w-20 h-20 bg-soft-pink/20 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i data-lucide="check" class="w-10 h-10 text-soft-pink"></i>
                </div>
                <h2 class="text-3xl font-light mb-2">預約成功！</h2>
                <p class="text-charcoal/60 mb-8">您的預約已同步至系統，時段已為您保留。</p>
                <div class="bg-ivory p-6 rounded-xl text-left space-y-3 mb-8 text-sm select-text">
                    <textarea id="copy-source" class="fixed opacity-0 pointer-events-none" style="left:-9999px"></textarea>
                    <p class="flex justify-between border-b border-grey-brown/20 pb-2"><span>日期：</span><span class="font-medium"><span id="success-date"></span></span></p>
                    <p class="flex justify-between border-b border-grey-brown/20 pb-2"><span>時段：</span><span class="font-medium" id="success-time"></span></p>
                    <p class="flex justify-between border-b border-grey-brown/20 pb-2"><span>姓名：</span><span class="font-medium" id="success-name"></span></p>
                    <p class="flex justify-between border-b border-grey-brown/20 pb-2"><span>金額：</span><span class="font-medium">NT$ <span id="success-price"></span></span></p>
                </div>
                <div class="mb-6 p-3 bg-gray-50 rounded-lg border border-dashed border-grey-brown/50">
                    <p class="text-xs text-charcoal/60 mb-1">若無法自動開啟，請手動搜尋 Line ID：</p>
                    <p class="text-lg font-bold text-charcoal tracking-wider select-all" id="display-line-id">anastasia38815</p>
                </div>
                <div class="space-y-3">
                    <button onclick="sendToLine()" class="w-full py-3 bg-[#00B900] text-white rounded-full font-medium shadow-md hover:bg-[#009900] transition-colors flex items-center justify-center gap-2 relative overflow-hidden group">
                        <span class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></span>
                        <i data-lucide="message-circle" class="w-4 h-4"></i>
                        複製並前往 Line 確認
                    </button>
                    <a href="https://line.me/ti/p/AtluluQUR4" target="_blank" class="block w-full py-2 text-xs text-grey-brown underline hover:text-charcoal cursor-pointer">
                        如果未自動轉跳，請點此開啟 LINE
                    </a>
                    <button onclick="resetAndReturnHome()" class="w-full py-3 bg-white border border-grey-brown text-charcoal rounded-full hover:bg-ivory transition-colors mt-2">
                        返回首頁
                    </button>
                </div>
                <p class="mt-4 text-[10px] text-charcoal/40 leading-relaxed">
                    請在 Line 對話框中 <strong>長按貼上</strong> 並傳送。<br>系統已自動鎖定您的預約時段。
                </p>
            </div>
        </div>

        <!-- Services -->
        <section id="services-section">
            <div class="text-center mb-16">
                <h2 class="text-3xl font-light tracking-widest mb-4">服務選單</h2>
                <div class="w-12 h-[1px] bg-grey-brown mx-auto"></div>
                <p class="mt-4 text-charcoal/70 font-light">請勾選您需要的服務項目，打造專屬方案</p>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6" id="services-container"></div>
        </section>

        <!-- Calendar -->
        <section class="bg-white rounded-3xl p-8 md:p-12 shadow-sm border border-ivory relative" id="calendar-section">
            
            <!-- Admin Dashboard -->
            <div id="admin-dashboard" class="hidden absolute inset-0 bg-white/95 z-40 rounded-3xl p-8 overflow-y-auto">
                <div class="flex justify-between items-center mb-6 border-b border-grey-brown/20 pb-4 sticky top-0 bg-white z-10">
                    <h3 class="text-xl font-bold text-charcoal">後台管理：預約紀錄</h3>
                    <button onclick="toggleAdminPanel(false)" class="p-2 hover:bg-ivory rounded-full"><i data-lucide="x" class="w-5 h-5"></i></button>
                </div>
                <div id="booking-list" class="space-y-4 pb-20 flex justify-center items-center h-40">
                    <div class="flex flex-col items-center gap-3 text-grey-brown">
                        <i data-lucide="loader-2" class="w-8 h-8 animate-spin"></i>
                        <span class="text-sm">正在同步雲端資料...</span>
                    </div>
                </div>
                <!-- Clear All Button -->
                <div class="fixed bottom-0 left-0 w-full p-4 bg-white border-t border-grey-brown/20 rounded-b-3xl">
                     <button onclick="window.clearAllBookings()" class="w-full py-3 bg-red-100 text-red-600 rounded-lg font-bold hover:bg-red-200 transition-colors">
                        ⚠️ 清除所有預約 (測試用)
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-16">
                <!-- Calendar Side -->
                <div>
                    <div class="flex justify-between items-center mb-6 flex-wrap gap-4">
                        <div class="flex gap-3 items-center">
                            <div class="relative">
                                <select id="year-select" onchange="updateCalendarView()" class="custom-select appearance-none bg-ivory border-none rounded-full px-4 py-2 pr-8 text-charcoal font-medium cursor-pointer focus:ring-1 focus:ring-grey-brown outline-none"></select>
                            </div>
                            <div class="relative">
                                <select id="month-select" onchange="updateCalendarView()" class="custom-select appearance-none bg-ivory border-none rounded-full px-4 py-2 pr-8 text-charcoal font-medium cursor-pointer focus:ring-1 focus:ring-grey-brown outline-none"></select>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="toggleAdminPanel(true)" id="view-bookings-btn" class="hidden flex items-center gap-2 px-3 py-1.5 rounded-full text-xs transition-all bg-ivory text-charcoal border border-grey-brown hover:bg-white">
                                <i data-lucide="list" class="w-3 h-3"></i> 查看訂單
                            </button>
                            <button onclick="handleAdminBtnClick()" id="admin-btn" class="flex items-center gap-2 px-3 py-1.5 rounded-full text-xs transition-all bg-ivory text-grey-brown hover:bg-grey-brown/20">
                                <i data-lucide="settings" class="w-3 h-3"></i>
                                <span id="admin-btn-text">管理排程</span>
                            </button>
                        </div>
                    </div>
                    <div id="admin-hint" class="hidden mb-4 text-xs text-soft-pink bg-ivory p-2 rounded text-center animate-pulse">
                        管理模式：點擊日期設定「全天休假」
                    </div>
                    <div class="grid grid-cols-7 gap-4 text-center mb-4">
                        <div class="text-xs text-grey-brown font-medium tracking-wider uppercase">SUN</div>
                        <div class="text-xs text-grey-brown font-medium tracking-wider uppercase">MON</div>
                        <div class="text-xs text-grey-brown font-medium tracking-wider uppercase">TUE</div>
                        <div class="text-xs text-grey-brown font-medium tracking-wider uppercase">WED</div>
                        <div class="text-xs text-grey-brown font-medium tracking-wider uppercase">THU</div>
                        <div class="text-xs text-grey-brown font-medium tracking-wider uppercase">FRI</div>
                        <div class="text-xs text-grey-brown font-medium tracking-wider uppercase">SAT</div>
                    </div>
                    <div class="grid grid-cols-7 gap-3 md:gap-4" id="calendar-grid"></div>
                    <div class="mt-6 flex items-center gap-6 text-xs text-charcoal/60">
                        <div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-charcoal"></div><span>已選日期</span></div>
                        <div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-soft-pink opacity-30"></div><span>已預約 / 休假</span></div>
                    </div>
                </div>

                <!-- Slots Side -->
                <div id="time-slot-section" class="transition-opacity duration-500 opacity-30 pointer-events-none" onclick="checkDateSelection()">
                    <h3 class="text-2xl font-light mb-8 flex items-center gap-3">
                        <i data-lucide="clock" class="w-5 h-5 text-grey-brown"></i>
                        選擇時段
                    </h3>
                    <div class="space-y-4 mb-10" id="slots-container"></div>
                    
                    <div id="booking-form" class="space-y-6 hidden animate-fade-in-up">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-charcoal">您的稱呼 (僅限中文) <span class="text-red-500">*</span></label>
                            <input type="text" id="input-name" required class="w-full bg-ivory border-none rounded-lg px-4 py-3 focus:ring-1 focus:ring-grey-brown outline-none transition-all" placeholder="請輸入中文姓名">
                            <p id="name-error" class="text-red-500 text-xs mt-1 hidden animate-pulse">姓名格式錯誤，請輸入 2 個字以上的純中文字</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-charcoal">聯絡電話 <span class="text-red-500">*</span></label>
                            <input type="tel" id="input-phone" required pattern="[0-9]*" inputmode="numeric" maxlength="10" class="w-full bg-ivory border-none rounded-lg px-4 py-3 focus:ring-1 focus:ring-grey-brown outline-none transition-all" placeholder="09xx-xxx-xxx">
                            <p id="phone-error" class="text-red-500 text-xs mt-1 hidden animate-pulse">電話格式無效，請輸入 09 開頭的 10 碼數字</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-charcoal">特殊需求備註</label>
                            <textarea id="input-note" rows="3" class="w-full bg-ivory border-none rounded-lg px-4 py-3 focus:ring-1 focus:ring-grey-brown outline-none resize-none" placeholder="例如：敏感肌膚、需要特殊風格、時間微調..."></textarea>
                        </div>
                        <div class="pt-6">
                            <button id="submit-btn" onclick="submitBooking()" disabled class="w-full py-4 rounded-full text-lg tracking-widest transition-all duration-300 shadow-xl bg-gray-200 text-gray-400 cursor-not-allowed">
                                確認預約 • NT$ <span id="final-price">0</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer Section -->
        <section class="text-center py-12">
            <p class="text-xl font-light mb-8 text-charcoal tracking-wider leading-relaxed">
                「讓您變美的同時，<br class="md:hidden">也能得到一張可以發社群的美照。」
            </p>
        </section>
    </main>

    <footer class="bg-white border-t border-ivory py-12">
        <div class="max-w-6xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center gap-8">
            <div class="text-center md:text-left">
                <h4 class="font-light tracking-[0.2em] text-lg mb-2">YU.YOU.MAKEUP</h4>
                <p class="text-xs text-grey-brown">© 2025 All Rights Reserved.</p>
                <p class="text-xs text-charcoal/60 mt-2 flex items-center justify-center md:justify-start gap-1">
                    Line ID: <span class="font-medium select-all">anastasia38815</span> 
                    <span class="text-[10px] text-grey-brown">(可手動加入)</span>
                </p>
            </div>
            <div class="flex gap-8 text-sm font-light text-charcoal/80">
                <a href="#" onclick="openInfoModal('terms'); return false;" class="hover:text-soft-pink transition-colors">服務條款</a>
                <a href="#" onclick="openInfoModal('privacy'); return false;" class="hover:text-soft-pink transition-colors">隱私權政策</a>
                <a href="#" onclick="openInfoModal('faq'); return false;" class="hover:text-soft-pink transition-colors">常見問題</a>
            </div>
            <div class="flex gap-6">
                <a href="https://www.instagram.com/yu.you_makeup?igsh=d255MTgyMnY4cWMx&utm_source=qr" target="_blank" class="w-10 h-10 rounded-full bg-ivory flex items-center justify-center text-charcoal hover:bg-soft-pink hover:text-white transition-all">
                    <i data-lucide="instagram" class="w-5 h-5"></i>
                </a>
                <a href="https://line.me/ti/p/AtluluQUR4" target="_blank" class="w-10 h-10 rounded-full bg-ivory flex items-center justify-center text-charcoal hover:bg-soft-pink hover:text-white transition-all">
                    <i data-lucide="message-circle" class="w-5 h-5"></i>
                </a>
            </div>
        </div>
    </footer>

    <!-- Cloud Sync & Logic -->
    <script type="module">
        // 1. 引入 Firebase SDK
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';
        import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';
        import { getFirestore, collection, doc, setDoc, deleteDoc, addDoc, onSnapshot, query, orderBy, getDocs } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';

        // ============================================================
        // ★ Firebase Config (User Provided) ★
        // ============================================================
        const firebaseConfig = {
            apiKey: "AIzaSyCw8iHYFSrjWTNffFZY6H60uzs_2NcYJdI",
            authDomain: "yuyou-makeup.firebaseapp.com",
            projectId: "yuyou-makeup",
            storageBucket: "yuyou-makeup.firebasestorage.app",
            messagingSenderId: "1014152374288",
            appId: "1:1014152374288:web:46a86e7d222aa293b50295",
            measurementId: "G-E9WPPFR27N"
        };

        // 2. 初始化 Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = 'yuyou-makeup-official-v1'; 

        const YOUR_LINE_LINK = 'https://line.me/ti/p/AtluluQUR4'; 
        const ADMIN_PASSWORD = "8888";

        // 3. 全域變數與資料 (包含 4 個服務選項 - 已更新描述文字)
        window.services = [
            { id: 1, title: '日常妝容造型', price: 500, duration: '1.5 小時', desc: '打造自然精緻氣色', note: '', icon: 'sparkles' },
            { id: 4, title: '加購日常髮型', price: 100, duration: '+30 分鐘', desc: '搭配妝容的簡易髮型設計', note: '需搭配妝容服務', icon: 'scissors' },
            { id: 2, title: '相機拍攝服務', price: 500, duration: '1.5-2 小時', desc: '造型完成後的專業拍攝<br>(含10張電子檔)', note: '外景拍攝費用另計', icon: 'camera' },
            { id: 3, title: '高階照片精修', price: 500, duration: '5個工作日交件', desc: '專業級細節與色彩調整<br>(共5張精修照片)', note: '追求極致完美的選擇', icon: 'wand-2' }
        ];

        window.timeSlots = [
            { id: 'A', label: '08:00 - 10:00', restriction: '僅限日常妝容造型' },
            { id: 'B', label: '10:00 - 14:00', restriction: null },
            { id: 'C', label: '14:00 - 18:00', restriction: null },
        ];

        window.state = {
            user: null,
            bookings: [],
            blockedDates: [],
            selectedServices: [],
            selectedDate: null, 
            selectedSlot: null,
            isAdminMode: false,
            totalPrice: 0,
            viewYear: 2025,
            viewMonth: 11 
        };

        const today = new Date();
        if (today.getFullYear() < 2025 || (today.getFullYear() === 2025 && today.getMonth() < 11)) {
            state.viewYear = 2025; state.viewMonth = 11; 
        } else {
            state.viewYear = today.getFullYear(); state.viewMonth = today.getMonth();
        }

        // 4. 啟動流程
        async function initApp() {
            await signInAnonymously(auth);
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    state.user = user;
                    const bookingsRef = collection(db, 'artifacts', appId, 'public', 'data', 'bookings');
                    onSnapshot(bookingsRef, (snapshot) => {
                        state.bookings = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                        state.bookings.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                        window.renderCalendar();
                        window.renderSlots();
                        if(!document.getElementById('admin-dashboard').classList.contains('hidden')) { window.toggleAdminPanel(true); }
                    });

                    const blockedRef = collection(db, 'artifacts', appId, 'public', 'data', 'blocked_dates');
                    onSnapshot(blockedRef, (snapshot) => {
                        state.blockedDates = snapshot.docs.map(doc => doc.id); 
                        window.renderCalendar();
                    });
                }
            });

            window.initDateSelectors();
            window.renderServices();
            window.renderCalendar();
            window.renderSlots();
            lucide.createIcons();
            
            document.getElementById('input-name').addEventListener('input', function() { document.getElementById('name-error').classList.add('hidden'); this.classList.remove('ring-2', 'ring-red-500'); });
            document.getElementById('input-phone').addEventListener('input', function() { document.getElementById('phone-error').classList.add('hidden'); this.classList.remove('ring-2', 'ring-red-500'); });
        }

        initApp();

        // --- Window Functions ---
        // Clear All
        window.clearAllBookings = async () => {
            if (!confirm("⚠️ 警告：確定要刪除「所有」預約嗎？此動作無法復原！")) return;
            if (prompt("請輸入管理密碼確認：") !== ADMIN_PASSWORD) return alert("密碼錯誤");
            
            try {
                if(state.bookings.length === 0) return alert("目前沒有預約資料可刪除。");
                alert("開始刪除 " + state.bookings.length + " 筆資料，請稍候...");
                const deletePromises = state.bookings.map(b => 
                    deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'bookings', b.id))
                );
                await Promise.all(deletePromises);
                alert("所有預約已清除完畢！");
            } catch (e) { alert("清除失敗：" + e.message); }
        }

        // Cancel Booking Function (Enhanced)
        window.cancelBooking = async (id) => {
            if(!confirm("確定要刪除此筆預約嗎？")) return;
            try {
                const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'bookings', id);
                await deleteDoc(docRef);
            } catch (e) { alert("刪除失敗：" + e.message); }
        }

        window.initDateSelectors = () => {
            const yearSelect = document.getElementById('year-select');
            const monthSelect = document.getElementById('month-select');
            const currentYear = new Date().getFullYear();
            for (let y = currentYear; y <= currentYear + 3; y++) {
                const opt = document.createElement('option'); opt.value = y; opt.innerText = y; yearSelect.appendChild(opt);
            }
            const monthNames = ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"];
            monthNames.forEach((m, idx) => {
                const opt = document.createElement('option'); opt.value = idx; opt.innerText = m; monthSelect.appendChild(opt);
            });
            yearSelect.value = state.viewYear;
            monthSelect.value = state.viewMonth;
        }

        window.updateCalendarView = () => {
            state.viewYear = parseInt(document.getElementById('year-select').value);
            state.viewMonth = parseInt(document.getElementById('month-select').value);
            window.renderCalendar();
        }

        window.renderServices = () => {
            const container = document.getElementById('services-container');
            container.innerHTML = window.services.map(service => {
                const isSelected = state.selectedServices.includes(service.id);
                return `
                <div onclick="toggleService(${service.id})" class="relative p-8 rounded-2xl border transition-all duration-300 cursor-pointer group ${isSelected ? 'bg-white border-soft-pink shadow-lg scale-[1.02]' : 'bg-white/50 border-transparent hover:border-grey-brown/50 hover:shadow-md'}">
                    <div class="absolute top-6 right-6 w-6 h-6 rounded-full border flex items-center justify-center transition-colors ${isSelected ? 'bg-soft-pink border-soft-pink' : 'border-grey-brown'}">${isSelected ? '<i data-lucide="check" class="w-4 h-4 text-white"></i>' : ''}</div>
                    <div class="mb-6 p-3 bg-ivory w-fit rounded-xl text-grey-brown"><i data-lucide="${service.icon}" class="w-6 h-6"></i></div>
                    <h3 class="text-xl font-normal mb-2">${service.title}</h3>
                    <div class="text-2xl font-light mb-4">NT$ ${service.price}</div>
                    <div class="space-y-2 text-sm text-charcoal/80 font-light">
                        <p class="flex items-start gap-2"><span class="block w-1 h-1 mt-2 rounded-full bg-grey-brown"></span>${service.desc}</p>
                        <p class="flex items-start gap-2"><span class="block w-1 h-1 mt-2 rounded-full bg-grey-brown"></span>${service.duration}</p>
                        ${service.note ? `<p class="text-xs text-grey-brown mt-4 pt-4 border-t border-ivory">* ${service.note}</p>` : ''}
                    </div>
                </div>`;
            }).join('');
            lucide.createIcons(); 
        }

        window.toggleService = (id) => {
            if (state.selectedServices.includes(id)) { state.selectedServices = state.selectedServices.filter(sid => sid !== id); } 
            else { 
                state.selectedServices.push(id); 
                if (state.selectedSlot === 'A' && id !== 1 && id !== 4) { 
                    state.selectedSlot = null; 
                    alert('溫馨提醒：時段 A (08:00-10:00) 僅提供「日常妝容造型」與「加購髮型」。\n如需拍攝或精修服務，請選擇 B 或 C 時段。'); 
                    window.renderSlots(); 
                } 
            }
            window.updateTotalPrice(); window.renderServices(); window.updateSubmitButton();
        }

        window.updateTotalPrice = () => {
            state.totalPrice = state.selectedServices.reduce((sum, id) => { const s = window.services.find(x => x.id === id); return sum + (s ? s.price : 0); }, 0);
            document.getElementById('total-price-display').innerText = state.totalPrice;
            document.getElementById('final-price').innerText = state.totalPrice;
            const priceBar = document.getElementById('price-bar');
            state.totalPrice > 0 ? priceBar.classList.remove('-translate-y-full') : priceBar.classList.add('-translate-y-full');
        }

        window.renderCalendar = () => {
            const grid = document.getElementById('calendar-grid');
            const firstDay = new Date(state.viewYear, state.viewMonth, 1).getDay(); 
            const daysInMonth = new Date(state.viewYear, state.viewMonth + 1, 0).getDate();
            let html = '';
            for(let i=0; i<firstDay; i++) { html += '<div></div>'; }
            for (let i = 1; i <= daysInMonth; i++) {
                const monthStr = (state.viewMonth + 1).toString().padStart(2, '0');
                const dayStr = i.toString().padStart(2, '0');
                const dateStr = `${state.viewYear}-${monthStr}-${dayStr}`;
                
                const isBlocked = state.blockedDates.includes(dateStr);
                const isSelected = state.selectedDate === dateStr;
                
                let btnClass = 'aspect-square flex items-center justify-center text-sm font-medium rounded-full transition-all duration-300 relative w-full ';
                if (state.isAdminMode) {
                    if (isBlocked) btnClass += 'bg-soft-pink text-white cursor-pointer ring-2 ring-offset-2 ring-soft-pink';
                    else btnClass += 'bg-white text-charcoal border border-dashed border-grey-brown hover:bg-ivory cursor-pointer';
                } else {
                    if (isBlocked) btnClass += 'bg-soft-pink/30 text-grey-brown cursor-not-allowed';
                    else if (isSelected) btnClass += 'bg-charcoal text-ivory shadow-md';
                    else btnClass += 'hover:bg-ivory text-charcoal cursor-pointer';
                }
                html += `<button onclick="handleDateClick('${dateStr}')" ${(!state.isAdminMode && isBlocked) ? 'disabled' : ''} class="${btnClass}">${i}</button>`;
            }
            grid.innerHTML = html;
        }

        window.changeMonth = (offset) => {
            state.viewMonth += offset;
            if (state.viewMonth > 11) { state.viewMonth = 0; state.viewYear++; } 
            else if (state.viewMonth < 0) { state.viewMonth = 11; state.viewYear--; }
            document.getElementById('year-select').value = state.viewYear;
            document.getElementById('month-select').value = state.viewMonth;
            window.renderCalendar();
        }

        window.handleDateClick = async (dateStr) => {
            if (state.isAdminMode) {
                const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'blocked_dates', dateStr);
                if (state.blockedDates.includes(dateStr)) { await deleteDoc(docRef); } else { await setDoc(docRef, { blocked: true }); if (state.selectedDate === dateStr) { state.selectedDate = null; state.selectedSlot = null; window.toggleTimeSection(false); } }
            } else {
                state.selectedDate = dateStr; state.selectedSlot = null;
                window.renderCalendar(); window.renderSlots(); window.toggleTimeSection(true);
                document.getElementById('time-slot-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            window.updateSubmitButton();
        }

        window.checkDateSelection = () => {
            if (!state.selectedDate && !state.isAdminMode) {
                alert('請先在左側日曆選擇您要預約的日期。');
                document.getElementById('calendar-grid').scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        window.toggleTimeSection = (show) => {
            const section = document.getElementById('time-slot-section');
            if (show) { section.classList.remove('opacity-30', 'pointer-events-none'); section.classList.add('opacity-100'); } 
            else { section.classList.add('opacity-30', 'pointer-events-none'); section.classList.remove('opacity-100'); }
        }

        window.renderSlots = () => {
            const container = document.getElementById('slots-container');
            const bookedSlotIds = state.bookings.filter(b => b.date === state.selectedDate).map(b => b.slotId);
            container.innerHTML = window.timeSlots.map(slot => {
                const isSelected = state.selectedSlot === slot.id;
                const isBooked = bookedSlotIds.includes(slot.id);
                if (isBooked) {
                    return `<div class="relative p-4 rounded-xl border border-gray-100 bg-gray-50 flex justify-between items-center cursor-not-allowed opacity-60"><div><span class="font-normal text-lg block text-gray-400 line-through">${slot.label}</span><span class="text-xs text-gray-400 flex items-center gap-1 mt-1">已預約額滿</span></div><div class="w-5 h-5 rounded-full border border-gray-200 flex items-center justify-center"></div></div>`;
                }
                return `<div onclick="handleSlotSelect('${slot.id}')" class="relative p-4 rounded-xl border flex justify-between items-center cursor-pointer transition-all ${isSelected ? 'bg-soft-pink border-soft-pink text-white shadow-md' : 'bg-white border-ivory hover:border-grey-brown/50 text-charcoal'}"><div><span class="font-normal text-lg block">${slot.label}</span>${slot.restriction ? `<span class="text-xs ${isSelected ? 'text-white/80' : 'text-grey-brown'} flex items-center gap-1 mt-1"><i data-lucide="info" class="w-3 h-3"></i> ${slot.restriction}</span>` : ''}</div><div class="w-5 h-5 rounded-full border flex items-center justify-center ${isSelected ? 'border-white bg-white' : 'border-grey-brown'}">${isSelected ? '<div class="w-2.5 h-2.5 rounded-full bg-soft-pink"></div>' : ''}</div></div>`;
            }).join('');
            lucide.createIcons();
            const form = document.getElementById('booking-form');
            state.selectedSlot ? form.classList.remove('hidden') : form.classList.add('hidden');
        }

        window.handleSlotSelect = (slotId) => {
            if (slotId === 'A') {
                const hasRestrictedServices = state.selectedServices.some(id => id !== 1 && id !== 4);
                if (hasRestrictedServices) { alert('溫馨提醒：時段 A (08:00-10:00) 僅提供「日常妝容造型」與「加購髮型」。\n如需拍攝或精修服務，請選擇 B 或 C 時段。'); return; }
            }
            state.selectedSlot = slotId;
            window.renderSlots(); window.updateSubmitButton();
            document.getElementById('booking-form').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        window.updateSubmitButton = () => {
            const btn = document.getElementById('submit-btn');
            const isValid = state.selectedDate && state.selectedSlot && state.totalPrice > 0;
            if (isValid) { btn.disabled = false; btn.classList.remove('bg-gray-200', 'text-gray-400', 'cursor-not-allowed'); btn.classList.add('bg-gradient-to-r', 'from-soft-pink', 'to-[#F6D1C1]', 'text-charcoal', 'hover:scale-105', 'hover:shadow-2xl'); } 
            else { btn.disabled = true; btn.classList.add('bg-gray-200', 'text-gray-400', 'cursor-not-allowed'); btn.classList.remove('bg-gradient-to-r', 'from-soft-pink', 'to-[#F6D1C1]', 'text-charcoal', 'hover:scale-105', 'hover:shadow-2xl'); }
        }

        window.scrollToNextStep = () => {
            if (state.selectedServices.length === 0) { document.getElementById('services-section').scrollIntoView({ behavior: 'smooth', block: 'start' }); alert('請先選擇至少一項服務'); } 
            else if (!state.selectedDate) { document.getElementById('calendar-section').scrollIntoView({ behavior: 'smooth', block: 'start' }); } 
            else if (!state.selectedSlot) { document.getElementById('time-slot-section').scrollIntoView({ behavior: 'smooth', block: 'start' }); } 
            else { document.getElementById('booking-form').scrollIntoView({ behavior: 'smooth', block: 'start' }); document.getElementById('input-name').focus(); }
        }

        window.resetAndReturnHome = () => {
            document.getElementById('success-view').classList.add('hidden');
            state.selectedServices = []; state.selectedDate = null; state.selectedSlot = null; state.totalPrice = 0;
            document.getElementById('input-name').value = ''; document.getElementById('input-phone').value = ''; document.getElementById('input-note').value = '';
            window.renderServices(); window.renderCalendar(); window.renderSlots(); window.updateTotalPrice(); window.toggleTimeSection(false); window.updateSubmitButton();
            window.scrollTo({ top: 0, behavior: 'smooth' });
            const originalSlogan = document.getElementById('main-slogan').innerHTML;
            document.getElementById('main-title').innerText = "感謝您的預約"; document.getElementById('main-slogan').innerText = "期待與您相見";
            setTimeout(() => { document.getElementById('main-title').innerHTML = "YU.YOU<br>MAKE UP"; document.getElementById('main-slogan').innerHTML = originalSlogan; }, 5000);
        }

        window.submitBooking = async () => {
            const name = document.getElementById('input-name').value.trim();
            const phone = document.getElementById('input-phone').value.trim();
            const note = document.getElementById('input-note').value.trim();
            document.getElementById('name-error').classList.add('hidden'); document.getElementById('phone-error').classList.add('hidden');
            let isValid = true;
            if (!/^[\u4e00-\u9fa5]{2,20}$/.test(name)) { document.getElementById('name-error').classList.remove('hidden'); isValid = false; }
            if (!/^09\d{8}$/.test(phone.replace(/[\s-]/g, ''))) { document.getElementById('phone-error').classList.remove('hidden'); isValid = false; }
            if (!isValid) return;

            const slotObj = window.timeSlots.find(s => s.id === state.selectedSlot);
            const bookingData = {
                date: state.selectedDate, slot: slotObj.label, slotId: state.selectedSlot,
                services: state.selectedServices.map(id => window.services.find(s => s.id === id).title),
                totalPrice: state.totalPrice, name: name, phone: phone, note: note, createdAt: new Date().toLocaleString()
            };

            await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'bookings'), bookingData);
            
            document.getElementById('copy-source').value = `您好，我想預約 YU.YOU.MAKEUP！\n------------------------\n日期：${bookingData.date}\n時段：${bookingData.slot}\n服務：${bookingData.services.join(', ')}\n金額：${bookingData.totalPrice}\n------------------------\n姓名：${bookingData.name}\n電話：${bookingData.phone}\n備註：${bookingData.note || '無'}`;
            document.getElementById('success-date').innerText = bookingData.date; document.getElementById('success-time').innerText = bookingData.slot;
            document.getElementById('success-name').innerText = bookingData.name; document.getElementById('success-price').innerText = bookingData.totalPrice;
            document.getElementById('success-view').classList.remove('hidden');
        }

        window.sendToLine = () => {
            const textArea = document.getElementById('copy-source');
            textArea.style.display = 'block'; textArea.select(); textArea.setSelectionRange(0, 99999);
            try { document.execCommand('copy'); document.getElementById('copy-toast').classList.remove('opacity-0'); } catch (err) {}
            setTimeout(() => { window.open(YOUR_LINE_LINK, '_blank'); }, 100);
        }

        window.manualCopy = () => {
            window.prompt("系統無法自動複製，請全選下方文字並複製，再前往 Line：", document.getElementById('copy-source').value);
            window.open(YOUR_LINE_LINK, '_blank');
        }

        // Info Modals content
        const infoContent = {
            terms: { title: "服務條款 (Terms of Service)", body: `<h4 class="font-bold text-charcoal text-base mb-2">1. 預約須知</h4><p>感謝您選擇 YU.YOU.MAKEUP。為了確保服務品質，請在送出預約單後，務必透過 Line 確認預約細節。預約完成以收到「預約成功確認訊息」為準。</p><h4 class="font-bold text-charcoal text-base mb-2 mt-4">2. 改期與取消政策</h4><p>如需更改日期或取消，請於預約時間前 **3 天** 透過 Line 告知。當天臨時取消或無故未到，可能會影響您未來的預約權益。</p><h4 class="font-bold text-charcoal text-base mb-2 mt-4">3. 遲到規範</h4><p>為尊重下一位客人的權益，請務必準時到達。若遲到超過 **15 分鐘**，我們保留縮短服務內容或取消預約的權利，敬請見諒。</p><h4 class="font-bold text-charcoal text-base mb-2 mt-4">4. 造型前準備</h4><ul class="list-disc pl-5 space-y-1"><li>請素顏前來（可擦基礎保養，勿上隔離霜）。</li><li>請於前一晚洗頭，並吹乾頭髮，切勿使用潤絲精或護髮油，以免影響髮型持久度。</li><li>若有配戴隱形眼鏡需求，建議提前配戴。</li></ul>` },
            privacy: { title: "隱私權政策 (Privacy Policy)", body: `<p>YU.YOU.MAKEUP 非常重視您的個人隱私。本政策說明我們如何蒐集、使用及保護您的資料。</p><h4 class="font-bold text-charcoal text-base mb-2 mt-4">1. 資料蒐集</h4><p>當您使用本預約平台時，我們可能會蒐集您的姓名、電話號碼及特殊需求備註。這些資料僅用於預約聯繫與服務確認。</p><h4 class="font-bold text-charcoal text-base mb-2 mt-4">2. 照片使用</h4><p>若您選擇「相機拍攝服務」，拍攝之照片版權歸 YU.YOU.MAKEUP 所有。我們可能會將精修後的作品用於官方社群媒體（Instagram/Facebook）作為作品集展示。若您不希望照片公開，請務必在「特殊需求備註」中告知，或於現場直接提出。</p><h4 class="font-bold text-charcoal text-base mb-2 mt-4">3. 資料保護</h4><p>未經您的同意，我們不會將您的個人資料透露給任何第三方，除非是為了完成服務（例如外景攝影師）或法律要求。</p>` },
            faq: { title: "常見問題 (FAQ)", body: `<div class="space-y-4"><div><h4 class="font-bold text-charcoal text-base">Q：完整妝髮造型需要多久時間？</h4><p class="mt-1">A：一般日常妝髮約需 1.5 小時；若包含拍攝服務，整體流程建議預留 3 - 4 小時。</p></div><div><h4 class="font-bold text-charcoal text-base">Q：我是敏感肌，使用的化妝品安全嗎？</h4><p class="mt-1">A：工具皆會定期清潔消毒。若您有極度敏感或特定成分過敏，請務必在預約備註中告知，或自備慣用的底妝產品。</p></div><div><h4 class="font-bold text-charcoal text-base">Q：可以帶朋友或寵物陪同嗎？</h4><p class="mt-1">A：因空間有限，且為了維護作業品質，不建議攜伴。請勿攜帶寵物。</p></div><div><h4 class="font-bold text-charcoal text-base">Q：如果是單眼皮或內雙，可以調整眼型嗎？</h4><p class="mt-1">A：可以的！我們會根據您的眼型條件，使用雙眼皮貼進行調整，打造最適合您的自然有神眼妝。</p></div></div>` }
        };
        window.openInfoModal = (type) => {
            const modal = document.getElementById('info-modal');
            if (infoContent[type]) {
                document.getElementById('info-modal-title').innerText = infoContent[type].title;
                document.getElementById('info-modal-content').innerHTML = infoContent[type].body;
                modal.classList.remove('hidden');
            }
        }
        window.closeInfoModal = () => document.getElementById('info-modal').classList.add('hidden');

        window.handleAdminBtnClick = () => { state.isAdminMode ? window.toggleAdminMode(false) : (document.getElementById('password-modal').classList.remove('hidden'), document.getElementById('admin-password-input').value = ''); }
        window.closePasswordModal = () => document.getElementById('password-modal').classList.add('hidden');
        window.verifyPassword = () => { document.getElementById('admin-password-input').value === ADMIN_PASSWORD ? (window.closePasswordModal(), window.toggleAdminMode(true)) : alert('密碼錯誤'); }
        window.toggleAdminMode = (enable) => {
            state.isAdminMode = enable;
            const btn = document.getElementById('admin-btn');
            const viewBtn = document.getElementById('view-bookings-btn');
            if (enable) { btn.classList.replace('bg-ivory', 'bg-charcoal'); btn.classList.replace('text-grey-brown', 'text-white'); document.getElementById('admin-btn-text').innerText = '完成設定'; document.getElementById('admin-hint').classList.remove('hidden'); viewBtn.classList.remove('hidden'); }
            else { btn.classList.replace('bg-charcoal', 'bg-ivory'); btn.classList.replace('text-white', 'text-grey-brown'); document.getElementById('admin-btn-text').innerText = '管理排程'; document.getElementById('admin-hint').classList.add('hidden'); viewBtn.classList.add('hidden'); }
            window.renderCalendar();
        }
        window.toggleAdminPanel = (show) => {
            const panel = document.getElementById('admin-dashboard');
            const list = document.getElementById('booking-list');
            if (show) {
                list.innerHTML = state.bookings.length === 0 ? '<p class="text-center text-charcoal/50 py-10">目前尚無預約資料</p>' : state.bookings.map(b => `
                    <div class="bg-ivory p-4 rounded-xl text-sm border-l-4 border-grey-brown relative">
                        <button onclick="event.stopPropagation(); window.cancelBooking('${b.id}')" class="absolute top-2 right-2 flex items-center gap-1 bg-red-50 text-red-500 hover:bg-red-100 hover:text-red-700 px-3 py-1.5 rounded-md shadow-sm border border-red-200 transition-colors z-50 cursor-pointer">
                            <span class="text-xs font-bold">刪除</span>
                        </button>
                        <div class="flex justify-between mb-2 pr-16"><span class="font-bold text-charcoal">${b.date} (${b.slot})</span><span class="text-xs text-charcoal/50">${b.createdAt}</span></div>
                        <div class="space-y-1 text-charcoal/80"><p>姓名：${b.name} / ${b.phone}</p><p>項目：${b.services.join(', ')}</p><p>金額：NT$ ${b.totalPrice}</p>${b.note ? `<p class="text-xs text-grey-brown bg-white p-2 rounded mt-2">備註：${b.note}</p>` : ''}</div>
                    </div>`).join('');
                lucide.createIcons();
                panel.classList.remove('hidden');
            } else { panel.classList.add('hidden'); }
        }
    </script>
</body>
</html>